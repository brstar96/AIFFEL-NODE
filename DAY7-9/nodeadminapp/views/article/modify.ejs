
<!--우측 콘텐츠 헤더영역 -->
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>게시글 확인 및 수정</h2>
        <ol class="breadcrumb">
            <li>
                <a href="/Home/Index">Home</a>>
            </li>
            <li>
                <a>게시글 확인 및 수정</a>>
            </li>
            <li class="active">
                <strong>수정</strong>
            </li>
        </ol>
    </div>
    <div class="col-lg-2">

    </div>
</div>

<!--우측 콘텐츠 영역 -->
<div class="wrapper wrapper-content">
<form id="articleForm" action="/article/modify/<%=article.aid%>" method="post">
    <div class="ibox-content m-b-sm border-bottom">

        <div class="row">
            <div class="col-sm-12">
                <div class="form-group">
                    <label class="control-label">글 제목</label>
                    <input type="text" id='title' name='title' value="<%=article.title%>" class="form-control">
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12">
                <div class="form-group">
                    <label class="control-label">글 내용</label>
                    <!-- id는 jquery를 통한 유효성 검사를 위함이고, name은 데이터 전달을 위해 지정 -->
                    <textarea class="form-control" id="contents" name="contents" rows="10" cols="5"><%=article.contents%></textarea> 
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    <label class="control-label">게시여부</label>
                    <select class="form-control" id="display_yn" name="display_yn">
                        <option value="Y" <% if(article.display_yn == "Y"){ %>selected<% } %>> 게시함</option>
                        <option value="N" <% if(article.display_yn == "N"){ %>selected<% } %>> 게시 안함</option>
                    </select>

                </div>
            </div>
        </div>

        <!-- 등록/목록 버튼 영역 -->
        <div class="text-center">
            <button type="submit" class="btn btn-primary">저장</button>
            <a href="/article/list" class="btn btn-info">목록</a>
            <button type="button" id="btnDelete" class="btn btn-danger">삭제</button>
            
            <!-- article.js의 라우터 내부에서 req.body를 통해 form요소에서 데이터 추출하는 것처럼 name 추출 가능.  -->
            <input type="hidden" name='aid' id="aid" value="<%=article.aid%>" /> 
        </div>

    </div>
</form>
</div>


    <script> // Jquery 스크립트 작성. 
        // document는 사용자 PC RAM에 적재되어 있는 DOM를 의미 
        // 서버에서 전달된 웹 페이지가 웹브라우저에 렌더링 완료되면 사용자 커서를 제목 영역으로 옮겨줌. 
        $(document).ready(function(){
            $('#title').focus();
        });

        // article form 태그에서 onsubmit 이벤트가 발생하면 캐치해 작동되는 함수 작성
        // form 태그 내 각종 입력 요소들의 유효성 검사를 실시 후 action에 저장된 페이지로 데이터를 보내도록 하기 
        // #는 태그 검색 prefix
        $('#articleForm').submit(function(){
            if($('#title').val() == ''){ // 제목 name 요소가 비어 있으면 
                alert('제목을 입력해 주세요.');
                $('#title').focus(); // 확인 버튼 눌렀을 때 해당 요소에 커서 옮겨놓기 
                return false; // 서버로 안넘어가고 멈춤. 
            }

            return true;
        });

        // 삭제버튼이 클릭되면 재확인 창을 띄우고 '확인'을 사용자가 클릭하면 삭제 url 호출 
        $('#btnDelete').click(function(){
            if(confirm('정말로 삭제하시겠습니까?')){ // 확인 버튼 누르면 실행
                // 여기서는 Model이 구현되지 않았으므로 아무것도 하지 않고 이동하도록 article.ejs의 /delete에 구현되어 있음
                location.href = '/article/delete?aid='+$('#aid').val(); 
            }else{ // 취소 버튼을 누르면 실행
                location.href = '/article/delete?aid='+$('#aid').val(); 
            }
        });

    </script>

</body>

</html>